##this code will produce complete solutions to "051117_Basic_R_Programming_Challenge_2_DH".
#
#import data files and merge. write output file.
omni_q_ldl_values <- read.table("OMNI_Q_LDL_VALUES.txt", header=TRUE, sep="")
omni_q_lipids_subset_demographics <- read.table("OMNI_Q_LIPIDS_SUBSET_DEMOGRAPHICS.txt", header=TRUE, sep="")
colnames(omni_q_lipids_subset_demographics)[1] <- "ID"
omni_q_ldl_demo_merge <- merge( omni_q_ldl_values, omni_q_lipids_subset_demographics, by=c("ID"))
write.table(omni_q_ldl_demo_merge, "omni_q_ldl_demo_merge.txt", col.names=TRUE, row.names=FALSE, quote=FALSE, sep="\t")
#
#stratify by ped/adult status.
omni_q_ldl_demo_merge$DOB <- as.Date(omni_q_ldl_demo_merge$DOB, format="%m/%d/%Y")
omni_q_ldl_demo_merge$LAB_DATE <- as.Date(omni_q_ldl_demo_merge$LAB_DATE, format="%m/%d/%Y")
omni_q_ldl_demo_merge$AGE <- trunc((unclass(as.Date(omni_q_ldl_demo_merge$LAB_DATE) - as.Date(omni_q_ldl_demo_merge$DOB)))/365.25)
write.table(omni_q_ldl_demo_merge, "omni_q_ldl_demo_merge.txt", col.names=TRUE, row.names=FALSE, quote=FALSE, sep="\t")
omni_q_ldl_ped <- subset(omni_q_ldl_demo_merge, omni_q_ldl_demo_merge$AGE < 18)
write.table(omni_q_ldl_ped, "omni_q_ldl_ped.txt", col.names=TRUE, row.names=FALSE, quote=FALSE, sep="\t")
omni_q_ldl_adult <- subset(omni_q_ldl_demo_merge, omni_q_ldl_demo_merge$AGE > 17)
write.table(omni_q_ldl_adult, "omni_q_ldl_adult.txt", col.names=TRUE, row.names=FALSE, quote=FALSE, sep="\t")
#
#generate summary stats.
summary_omni_q_ldl_ped <- summary(omni_q_ldl_ped)
write.table(summary_omni_q_ldl_ped, "summary_omni_q_ldl_ped.txt", col.names=TRUE, row.names=FALSE, quote=FALSE, sep="\t")
summary_omni_q_ldl_adult <- summary(omni_q_ldl_adult)
write.table(summary_omni_q_ldl_adult, "summary_omni_q_ldl_adult.txt", col.names=TRUE, row.names=FALSE, quote=FALSE, sep="\t")
#
#calculate mean and median ldl values for each subject.
median_individual_omni_q_ldl_ped <- aggregate(omni_q_ldl_ped$LAB_VALUE, list(omni_q_ldl_ped$ID), median, na.rm=TRUE)
mean_individual_omni_q_ldl_ped <- aggregate(omni_q_ldl_ped$LAB_VALUE, list(omni_q_ldl_ped$ID), mean, na.rm=TRUE)
colnames(median_individual_omni_q_ldl_ped) <- c("ID", "median")
colnames(mean_individual_omni_q_ldl_ped) <- c("ID", "mean")
median_mean_individual_omni_q_ped <- merge(median_individual_omni_q_ldl_ped, mean_individual_omni_q_ldl_ped, by=c("ID"))
median_mean_individual_demo_omni_q_ped_prelim <- merge(median_mean_individual_omni_q_ped, omni_q_ldl_demo_merge, by=c("ID"))
median_mean_individual_demo_omni_q_ped <- subset(median_mean_individual_demo_omni_q_ped_prelim, median_mean_individual_demo_omni_q_ped$AGE < 18)
write.table(median_mean_individual_demo_omni_q_ped, "median_mean_individual_demo_omni_q_ped.txt", col.names=TRUE, row.names=FALSE, quote=FALSE, sep="\t")
median_individual_omni_q_ldl_adult <- aggregate(omni_q_ldl_adult$LAB_VALUE, list(omni_q_ldl_adult$ID), median, na.rm=TRUE)
mean_individual_omni_q_ldl_adult <- aggregate(omni_q_ldl_adult$LAB_VALUE, list(omni_q_ldl_adult$ID), mean, na.rm=TRUE)
colnames(median_individual_omni_q_ldl_adult) <- c("ID", "median")
colnames(mean_individual_omni_q_ldl_adult) <- c("ID", "mean")
median_mean_individual_omni_q_adult <- merge(median_individual_omni_q_ldl_adult, mean_individual_omni_q_ldl_adult, by=c("ID"))
median_mean_individual_demo_omni_q_adult_prelim <- merge(median_mean_individual_omni_q_adult, omni_q_ldl_demo_merge, by=c("ID"))
median_mean_individual_demo_omni_q_adult <- subset(median_mean_individual_demo_omni_q_adult_prelim, median_mean_individual_demo_omni_q_ped$AGE > 17)
write.table(median_mean_individual_demo_omni_q_adult, "median_mean_individual_demo_omni_q_adult.txt", col.names=TRUE, row.names=FALSE, quote=FALSE, sep="\t")
#
#generate histogram of ldl lab values and save as pdf.
pdf("omni_q_ldl_adult_hist.pdf")
hist(median_mean_individual_demo_omni_q_adult$median, main="Omni-q adult median LDL")
dev.off()
#
#generate scatterplot of ldl lab values and save as pdf.
pdf("omni_q_ldl_adult_plot.pdf")
plot(median_mean_individual_demo_omni_q_adult$median, main="Omni-q adult median LDL")
dev.off()
#
#generate boxplot of ldl lab values by gender and save as pdf.
pdf("omni_q_ldl_by_gender.pdf")
plot(median_mean_individual_demo_omni_q_adult$GENDER, median_mean_individual_demo_omni_q_adult$median, main="Omni-q adult median LDL")
dev.off()
